---
title: "Intro to Data Science - Group1 Project1"
author: "Manoj"
date: "2023-10-06"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```
#Question1
Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
```{r}
Nasdaq=read.csv("/Users/manojpadala/Desktop/Intro to data Science/Nasdaq 100 Historical Data.csv")
SP500=read.csv("/Users/manojpadala/Desktop/Intro to data Science/S&P 500 Historical Data.csv")
USDIndex=read.csv("/Users/manojpadala/Desktop/Intro to data Science/US Dollar Index Historical Data.csv") 
Nasdaq$Date <- as.Date(Nasdaq$Date, format = "%m/%d/%Y")
Nasdaq <- subset(Nasdaq, select = -Vol.)
SP500$Date <- as.Date(SP500$Date, format = "%m/%d/%Y")
SP500 <- subset(SP500, select = -Vol.)
USDIndex$Date <- as.Date(USDIndex$Date, format = "%m/%d/%Y")
USDIndex <- subset(USDIndex, select = -Vol.)
Nasdaq=Nasdaq[rev(1:nrow(Nasdaq)), ]
SP500=SP500[rev(1:nrow(SP500)), ]
USDIndex=USDIndex[rev(1:nrow(USDIndex)), ]
SP500$Price <- as.numeric(gsub(",", "", SP500$Price))
Nasdaq$Price <- as.numeric(gsub(",", "", Nasdaq$Price))

str(Nasdaq)
str(USDIndex)
str(SP500)
missing_values <- sum(is.na(Nasdaq))
missing_values <- sum(is.na(SP500))
correlation_coefficient <- cor(Nasdaq$Price,USDIndex$Price)
# Merge the data frames to filter USDIndex by Nasdaq's dates
merged_data <- merge(Nasdaq, USDIndex, by = "Date")
str(merged_data)

# Now you can calculate the correlation
correlation_coefficient <- cor(merged_data$Price.x, merged_data$Price.y)
p_value <- correlation_coefficient$p.value

# Print or use the p-value as needed
cat("Pearson Correlation Test P-Value:", p_value, "\n")
ggplot(merged_data, aes(x = Price.x, y = Price.y)) +
  geom_line() +
  labs(
    title = "Scatter Plot: Nasdaq vs. USD Index",
    x = "Nasdaq",
    y = "USD Index"
  ) +
  theme_minimal()
```
ggplot() +
  geom_point(data = Nasdaq, aes(x = Date, y = Price, color = "Nasdaq"), size = 0.25) +
  geom_point(data = SP500, aes(x = Date, y = Price, color = "S&P 500"), size = 0.25) +
  labs(
    title = "Nasdaq and S&P 500 Comparison",
    x = "Date",
    y = "Price",
    color = "Index"
  ) +
  scale_color_manual(values = c("Nasdaq" = "blue", "S&P 500" = "red")) +
  theme_minimal()
install.packages("ggplot2")
library(ggplot2)

# Assuming you have Date, Nasdaq, and SP500 columns in your data frames

# Create a scatter plot
plot=
ggplot() +
  geom_line(data = Nasdaq, aes(x = Nasdaq$Price, y = SP500$Price), size = .25) +
  labs(
    title = "Nasdaq vs. S&P 500",
    x = "Nasdaq",
    y = "S&P 500"
  ) +
  theme_minimal()
  plot + scale_x_continuous(limits = c(1000, 12000))

lm(abline)


```{r}

```
