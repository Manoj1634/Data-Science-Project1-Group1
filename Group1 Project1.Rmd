---
title: "Intro to Data Science - Group1 Project1"
author: "Group 1"
date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: hide
    number_sections: false
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '3'
---
```{r, echo=FALSE}
setwd("/Users/moustaphacisse")
```

## Question1

```{r, echo=FALSE}
library(readr)
library(readxl)
library(utils)
Nasdaq <- read_csv("Nasdaq 100 Historical Data.csv")
SP500 <- read_csv("S&P 500 Historical Data.csv")
USDIndex <- read_csv("US Dollar Index Historical Data.csv") 
Nasdaq$Date <- as.Date(Nasdaq$Date, format = "%m/%d/%Y")
Nasdaq <- subset(Nasdaq, select = -Vol.)
SP500$Date <- as.Date(SP500$Date, format = "%m/%d/%Y")
SP500 <- subset(SP500, select = -Vol.)
USDIndex$Date <- as.Date(USDIndex$Date, format = "%m/%d/%Y")
USDIndex <- subset(USDIndex, select = -Vol.)
Nasdaq=Nasdaq[rev(1:nrow(Nasdaq)), ]
SP500=SP500[rev(1:nrow(SP500)), ]
USDIndex=USDIndex[rev(1:nrow(USDIndex)), ]
SP500$Price <- as.numeric(gsub(",", "", SP500$Price))
Nasdaq$Price <- as.numeric(gsub(",", "", Nasdaq$Price))

str(Nasdaq)
str(USDIndex)
str(SP500)
missing_values <- sum(is.na(Nasdaq))
missing_values <- sum(is.na(SP500))
```

#   1-    Histograms

```{r, echo=FALSE}
library(ggplot2)
ggplot(Nasdaq, aes(x = Price)) +
  geom_histogram(binwidth = 10, fill = "blue", color = "black") +
  labs(title = "Nasdaq Price Histogram", x = "Price", y = "Frequency")
ggplot(USDIndex, aes(x = Price)) +
  geom_histogram(binwidth = 0.5, fill = "green", color = "black") +
  labs(title = "USDIndex Price Histogram", x = "Price", y = "Frequency")
ggplot(SP500, aes(x = Price)) +
  geom_histogram(binwidth = 10, fill = "red", color = "black") +
  labs(title = "SP500 Price Histogram", x = "Price", y = "Frequency")
```

Each histogram shows us that the different variable: "US Dollar index", "Nasdaq Index" and "S&P500" are normally distributted with different skewedness acroos the plot.

# 2-    Boxplot for each variables

```{r, echo=FALSE}
library(ggplot2)
ggplot(Nasdaq, aes(y = Price)) +
  geom_boxplot() +
  labs(title = "Nasdaq Price Box Plot")
ggplot(USDIndex, aes(y = Price)) +
  geom_boxplot() +
  labs(title = "USDIndex Price Box Plot")
ggplot(SP500, aes(y = Price)) +
  geom_boxplot() +
  labs(title = "SP500 Price Box Plot")
```

Accoording to these boxplots, we only have outliers with our Nasdaq variable.

# 3-    Merge the data frames to filter USDIndex by Nasdaq's dates

```{r, echo=FALSE}
merged_data <- merge(Nasdaq, USDIndex, by = "Date")
str(merged_data)
```

# 4-    Correlation between Nasdaq & US Dollar price Index

```{r, echo=FALSE}
corr_coef <- cor(merged_data$Price.x, merged_data$Price.y)
cat("Pearson Correlation Test :", corr_coef, "\n")
```

A correlation coefficient of 0.71246 between the US Dollar Index and the Nasdaq Index Price suggests a relatively strong positive linear relationship between these two variables. Meaning that when the US Dollar Index increases, the Nasdaq Index tends to increase as well.

# 5-    Line Plots
#   a-    Nasdaq Index & US Dollar Index

```{r, echo=FALSE}
library(ggplot2)
library(gridExtra)

plot_nasdaq <- ggplot(data = merged_data, aes(x = Date)) +
  geom_line(aes(y = Price.x, color = "Nasdaq")) +
  labs(x = "Date", y = "Price") +
  scale_color_manual(values = c("Nasdaq" = "blue")) +
  ggtitle("Nasdaq Index Price")
plot_USDollar <- ggplot(data = merged_data, aes(x = Date)) +
  geom_line(aes(y = Price.y, color = "US Dollar")) +
  labs(x = "Date", y = "Price") +
  scale_color_manual(values = c("US Dollar" = "red")) +
  ggtitle("US Dollar Index Price")
grid.arrange(plot_nasdaq, plot_USDollar, ncol = 2)
```

These two line plots are showing a similar trend. With each upward or downward trend noticed in Nasdaq plot, we can aslo find similar trend on US Dollar plot at any time t.

#   b-    Nasdaq and S&P 500

```{r, echo=FALSE} 
ggplot() +
  geom_line(data = Nasdaq, aes(x = Date, y = Price, color = "Nasdaq"), size = 0.75) +
  geom_line(data = SP500, aes(x = Date, y = Price, color = "S&P 500"), size = 0.75) +
  labs(
    title = "Nasdaq and S&P 500 Comparison",
    x = "Date",
    y = "Price",
    color = "Index"
  ) +
  scale_color_manual(values = c("Nasdaq" = "green", "S&P 500" = "lightblue")) +
  theme_minimal()
```

From this comparison line plot, we can infer that Nasdaq and S&P500 have a positive relationship. Even though subtle, we can follow the movement of both variables across the chosen time frame and note that in every increase in S&P500 Index, there is also a quite significant increase in Nasdq Index.

# 6-    Scatter plot

```{r, echo=FALSE}
ggplot(data = SP500, aes(x = Price, y = Nasdaq$Price)) +
     geom_point() +
     labs(x = "S&P 500 Price", y = "Nasdaq Price") +
     ggtitle("Scatter Plot of S&P 500 Price vs. Nasdaq Price")
```

With this scatter plot, we can better identify the positive relationship betwwen S$P 500 Index and Nasdaq Index. we can infer that with every increase in Nasdaq, we can expect S&P 500 to increase as well.

## Question 2 : How the fluctuations in the prices of Gold, Silver, Natural Gas and Crude Oil in the global markets have affected the performance of the US Dollar over the last 15 years.

# 1-    Cleaning dataset.

```{r, echo=FALSE}
library(readr)
library(readxl)
library(magrittr)
library(dplyr)
USDollar <- read_csv("US Dollar Index Historical Data.csv")
CrudeOil <- read_csv("Crude Oil WTI Futures Historical Data.csv")
Nat_Gas <- read_csv("Natural Gas Futures Historical Data.csv")
Gold <- read_csv("Gold Futures Historical Data.csv")
Silver <- read_csv("Silver Futures Historical Data.csv")

CrudeOil <- CrudeOil %>% mutate(Date = as.Date(Date, format = "%m/%d/%Y"))
Gold <- Gold %>% mutate(Date = as.Date(Date, format = "%m/%d/%Y"))
Nat_Gas <- Nat_Gas %>% mutate(Date = as.Date(Date, format = "%m/%d/%Y"))
Silver <- Silver %>% mutate(Date = as.Date(Date, format = "%m/%d/%Y"))
USDollar <- USDollar %>% mutate(Date = as.Date(Date, format = "%m/%d/%Y"))
```

# 2-    Box plot
```{r, echo=FALSE}
library(ggplot2)
library(gridExtra)

C <- ggplot(data = CrudeOil, aes(x = "", y = Price)) +
  geom_boxplot(fill = "blue") +
  labs(title = "Crude Oil Price Box Plot",
       x = "",
       y = "Price") +
  theme_minimal()
G <- ggplot(data = Gold, aes(x = "", y = Price)) +
  geom_boxplot(fill = "yellow") +
  labs(title = "Gold Price Box Plot",
       x = "",
       y = "Price") +
  theme_minimal()
grid.arrange(C, G, ncol = 2)

GN <- ggplot(data = Nat_Gas, aes(x = "", y = Price)) +
  geom_boxplot(fill = "green") +
  labs(title = "Natural Gas Price Box Plot",
       x = "",
       y = "Price") +
  theme_minimal()
S <- ggplot(data = Silver, aes(x = "", y = Price)) +
  geom_boxplot(fill = "gray") +
  labs(title = "Silver Price Box Plot",
       x = "",
       y = "Price") +
  theme_minimal()
grid.arrange(GN, S, ncol = 2)

ggplot(data = USDollar, aes(x = "", y = Price)) +
  geom_boxplot(fill = "red") +
  labs(title = "U.S. Dollar Price Box Plot",
       x = "",
       y = "Price") +
  theme_minimal()
```

 From these boxplot, we can see that only Natural gas and Silver have several potential outliers. 

# 3- Line plots
# a-    Crude oil and U.S. Dollar

```{r, echo=FALSE}
library(ggplot2)
ggplot(data = CrudeOil, aes(x = Date)) +
  geom_line(aes(y = Price, color = "Crude Oil"), size = 1) +
  geom_line(data = USDollar, aes(y = Price, color = "U.S. Dollar"), size = 1) +
  labs(title = "Crude Oil Price vs. U.S. Dollar",
       x = "Date",
       y = "Price",
       color = "Commodity") +
  scale_color_manual(values = c("Crude Oil" = "blue", "U.S. Dollar" = "red")) +
  theme_minimal()
```

Even though subtle, We can still notice that as crude oil price increases, U.S. Dollar index decreases and vice versa. Therefore, we can conclude that there is an inverse relationship between those two varaibles.

# b-    Gold and U.S. Dollar

```{r, echo=FALSE}
ggplot(data = Gold, aes(x = Date)) +
  geom_line(aes(y = Price, color = "Gold"), size = 1) +
  geom_line(data = USDollar, aes(y = Price, color = "U.S. Dollar"), size = 1) +
  labs(title = "Gold Price vs. U.S. Dollar",
       x = "Date",
       y = "Price",
       color = "Commodity") +
  scale_color_manual(values = c("Gold" = "yellow", "U.S. Dollar" = "pink")) +
  theme_minimal()
```

This graph is pretty simple. We can see that there is no changes in the U.S. Dollar Index as the price of gold keep changing. Therefore, there is no relationship between Gold and U.S. Dollar.

# c-    Natural Gas and U.S. Dollar

```{r, echo=FALSE}
ggplot(data = Nat_Gas, aes(x = Date)) +
  geom_line(aes(y = Price, color = "Nat_Gas"), size = 1) +
  geom_line(data = USDollar, aes(y = Price, color = "U.S. Dollar"), size = 1) +
  labs(title = "Natural Gas Price vs. U.S. Dollar",
       x = "Date",
       y = "Price",
       color = "Commodity") +
  scale_color_manual(values = c("Natural Gas" = "purple", "U.S. Dollar" = "turquoise")) +
  theme_minimal()
```

Overall, We can see that the price of natural gas has have a steady decline over the years. however, at the same time, we can also notice that the U.S. Dollar increase. This indicates a negative relationship between Natural gas and U.S. Dollar.

# d-    Silver and U.S. Dollar

```{r, echo=FALSE}
ggplot(data = Silver, aes(x = Date)) +
  geom_line(aes(y = Price, color = "Silver"), size = 1) +
  geom_line(data = USDollar, aes(y = Price, color = "U.S. Dollar"), size = 1) +
  labs(title = "Silver Price vs. U.S. Dollar",
       x = "Date",
       y = "Price",
       color = "Commodity") +
  scale_color_manual(values = c("Silver" = "lightblue", "U.S. Dollar" = "lightgreen")) +
  theme_minimal()
```

From the line plot, we can infer that there is a negative relationship between Silver and U.S. Dollar Index. As Silver price increases, the U.S. Dollar index decreases and vice versa.

# Question3 : What are the dynamic relationships among the S&P 500, NASDAQ Composite Index, and the Crypto 10 Index, and how do fluctuations in trading volumes.

# 1-    Cleaning datasets.

```{r, echo=FALSE}
library(readr)
Nasdaq <- read_csv("Nasdaq 100 Historical Data.csv")
SP500 <- read_csv("S&P 500 Historical Data.csv")
crypto10 <- read_csv("crypto10index.csv")

Nasdaq <- Nasdaq %>% mutate(Date = as.Date(Date, format = "%m/%d/%Y"))
SP500 <- SP500 %>% mutate(Date = as.Date(Date, format = "%m/%d/%Y"))
crypto10 <- crypto10 %>% mutate(Date = as.Date(Date, format = "%m/%d/%Y"))
```

```{r, echo=FALSE}
cat("Missing values in Nasdaq Price column: ", sum(is.na(Nasdaq$Price)), "\n")
cat("Missing values in crypto10 Price column: ", sum(is.na(crypto10$Price)), "\n")
cat("Missing values in SP500 Price column: ", sum(is.na(SP500$Price)), "\n")
```

We do not have any missing values in chosen variables.




